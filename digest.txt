Directory structure:
‚îî‚îÄ‚îÄ static/
    ‚îú‚îÄ‚îÄ index.html
    ‚îú‚îÄ‚îÄ css/
    ‚îÇ   ‚îú‚îÄ‚îÄ auth.css
    ‚îÇ   ‚îî‚îÄ‚îÄ styles.css
    ‚îî‚îÄ‚îÄ js/
        ‚îú‚îÄ‚îÄ api.js
        ‚îú‚îÄ‚îÄ auth.js
        ‚îú‚îÄ‚îÄ handlers.js
        ‚îú‚îÄ‚îÄ main.js
        ‚îî‚îÄ‚îÄ toast.js

================================================
FILE: index.html
================================================
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaskMaster</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="stylesheet" href="/static/css/auth.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
          integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
          crossorigin="anonymous">
</head>
<body>
<div class="container">
    <header class="header">
        <div class="tabs">
            <button class="tab-button active" id="newTab">–ù–æ–≤–∞—è</button>
            <button class="tab-button" id="openTab">–û—Ç–∫—Ä—ã—Ç—ã–µ</button>
            <button class="tab-button" id="closedTab">–ó–∞–∫—Ä—ã—Ç—ã–µ</button>
        </div>
        <div class="logo">VistaTask</div>
        <div class="auth-buttons" id="loginButtons">
            <button class="auth-button" id="registerBtn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
        </div>
        <div class="user-info-container hidden" id="outButtons">
            <span id="usernameDisplay" class="username-display"></span>
            <button class="auth-button" id="logoutBtn">–í—ã—Ö–æ–¥</button>
    </div>
    </header>

    <main class="content">
        <!-- –í–∫–ª–∞–¥–∫–∞ "–ù–æ–≤–∞—è" -->
        <div id="newContent" class="tab-content">
            <form class="new-task-form">
                <div class="form-row">
                    <label for="lpu">–õ–ü–£:</label>
                    <!-- –ó–Ω–∞—á–µ–Ω–∏–µ –∑–∞–¥–∞–µ—Ç—Å—è –∏–∑ JS, data-org-code —Ö—Ä–∞–Ω–∏—Ç –∫–æ–¥ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ -->
                    <input type="text" id="lpu" value="–ì–ü 17" data-org-code="p17" readonly>
                </div>
                <div class="form-row">
                    <label for="taskType">–ü—Ä–æ–µ–∫—Ç:</label>
                    <select id="taskType">
                        <option value="web-reports">–í–µ–ø –ê—á–æ—Ç—ã</option>
                        <option value="vista-desktop">–±–æ–∂–µ —Ö—Ä–∞–Ω–∏ python2.7 (–¥–µ—Å–∫)</option>
                        <option value="iemk">(–≤–æ–ø—Ä–æ—Å—ã –¢–û–õ–¨–ö–û –ø–æ IEMKv2py3)</option>
                        <option value="doctorroom">–±–æ–∂–µ —Ö—Ä–∞–Ω–∏ php (doctorroom)</option>
                        <option value="templates">—à–∞–±–ª–æ–Ω—ã...</option>
                    </select>
                </div>
                <div class="form-row">
                    <label for="subject">–¢–µ–º–∞:</label>
                    <input type="text" id="subject" required minlength="3">
                </div>
                <div class="form-row text-area-row">
                    <label for="text">–¢–µ–∫—Å—Ç:</label>
                    <textarea id="text" required></textarea>
                </div>
                <div class="form-row file-upload-row">
                    <label for="files">–§–∞–π–ª—ã:</label>
                    <div class="file-area">
                        <div class="file-drop-area" id="fileDropArea">
                            –ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∏—Ö —Å—é–¥–∞
                            <input type="file" id="files" multiple style="display: none;">
                            <span class="download-icon">‚Üì</span>
                        </div>
                        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–ø–∏—Å–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ -->
                        <div id="fileListContainer"></div>
                    </div>
                </div>
                <div class="form-footer">
                    <button type="submit" class="action-button">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </div>
            </form>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ "–û—Ç–∫—Ä—ã—Ç—ã–µ" -->
        <div id="openContent" class="tab-content hidden">
            <div class="left-panel">
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ –∑–∞–¥–∞—á..." class="search-input">
                </div>
                <div class="tasks-list">
                    <!-- –°—é–¥–∞ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–µ –∑–∞–¥–∞—á–∏ -->
                </div>
            </div>
            <div class="right-panel">
                <div class="right-panel-title">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–¥–∞—á—É</div>
                <div class="details"></div>
                <div class="right-panel-description"></div>
                <div class="files-section">
                    <h3>–ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã</h3>
                    <div class="files-grid">
                        <!-- –°—é–¥–∞ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —Ñ–∞–π–ª—ã -->
                    </div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ "–ó–∞–∫—Ä—ã—Ç—ã–µ" -->
        <div id="closedContent" class="tab-content hidden">
            <div class="left-panel">
                <div class="search-container">
                    <input type="text" id="searchInputClosed" placeholder="–ü–æ–∏—Å–∫ –∑–∞–¥–∞—á..." class="search-input">
                </div>
                <div class="tasks-list">
                    <!-- –°—é–¥–∞ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –∑–∞–∫—Ä—ã—Ç—ã–µ –∑–∞–¥–∞—á–∏ -->
                </div>
            </div>
            <div class="right-panel">
                <div class="right-panel-title">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–¥–∞—á—É</div>
                <div class="details"></div>
                <div class="right-panel-description"></div>
                <div class="files-section">
                    <h3>–ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã</h3>
                    <div class="files-grid">
                        <!-- –°—é–¥–∞ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —Ñ–∞–π–ª—ã -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal –¥–ª—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π -->
    <div id="imageModal" class="modal hidden">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <img id="modalImage" src="" alt="">
            <div class="modal-info">
                <div class="modal-filename"></div>
                <div class="modal-actions">
                    <a id="modalDownload" href="" download class="modal-button">–°–∫–∞—á–∞—Ç—å</a>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal –¥–ª—è –≤—ã–≤–µ–¥–µ–Ω–∏—è —Ñ–æ—Ä–º—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
    <div id="authModal" class="auth_wrapper modal hidden">
        <span class="modal-close">&times;</span>
        <div class="container right-panel-active" id="authContainer">
            <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
            <div class="form-container sign-up-container">
                <form id="registerForm">
                    <h1>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h1>
                    <input name="username" type="text" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required/>
                    <input name="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å" required/>
                    <input name="password_confirm" type="password" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required/>
                    <button type="submit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                </form>
            </div>

            <!-- –§–æ—Ä–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
            <div class="form-container sign-in-container">

                <form id="loginForm">
                    <h1>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h1>
                    <input name="username" type="text" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required/>
                    <input name="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å" required/>
                    <button type="submit">–í—Ö–æ–¥</button>
                </form>
            </div>

            <div class="overlay-container">
                <div class="overlay">
                    <div class="overlay-panel overlay-left">
                        <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h1>
                        <p>–ß—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –Ω–∞ —Å–≤—è–∑–∏ —Å –Ω–∞–º–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É.</p>

                        <button class="ghost" id="switchToLoginBtn">–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</button>
                    </div>
                    <div class="overlay-panel overlay-right">
                        <h1>–ü—Ä–∏–≤–µ—Ç, –î—Ä—É–≥!</h1>
                        <p>–í–≤–µ–¥–∏—Ç–µ —Å–≤–æ–∏ –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –Ω–∞—á–Ω–∏—Ç–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≤–º–µ—Å—Ç–µ —Å –Ω–∞–º–∏.</p>
                        <button class="ghost" id="switchToRegisterBtn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>
</div>

<script type="module" src="/static/js/main.js"></script>
</body>
</html>


================================================
FILE: css/auth.css
================================================
@import url('https://fonts.googleapis.com/css?family=Montserrat:400,800');

.auth_wrapper {
    color: #000;
	box-sizing: border-box;
    font-family: 'Montserrat', sans-serif;
    background-color: rgba(0, 0, 0, 0.5);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: -0px 0 0px;
    margin-top: 0px;
}

.auth_wrapper h1 {
    font-weight: bold;
    margin: 0;
}

.auth_wrapper p {
    font-size: 14px;
    font-weight: 100;
    line-height: 20px;
    letter-spacing: .5px;
    margin: 20px 0 30px;
}

.auth_wrapper span {
    font-size: 12px;
}

.auth_wrapper a {
    color: #333;
    font-size: 14px;
    text-decoration: none;
    margin: 15px 0;
}

.auth_wrapper .container {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 14px 28px rgba(0, 0, 0, .25), 0 10px 10px rgba(0, 0, 0, .22);
    position: relative;
    overflow: hidden;
    width: 768px;
    max-width: 100%;
    min-height: 480px;
}

.auth_wrapper .form-container form {
    background: #fff;
    display: flex;
    flex-direction: column;
    padding: 0 50px;
    height: 100%;
    justify-content: center;
    align-items: center;
    text-align: center;
}

.auth_wrapper .social-container {
    margin: 20px 0;
}

.auth_wrapper .social-container a {
    border: 1px solid #ddd;
    border-radius: 50%;
    display: inline-flex;
    justify-content: center;
    align-items: center;
    margin: 0 5px;
    height: 40px;
    width: 40px;
}

.auth_wrapper .form-container input {
    background: #eee;
    border: none;
    padding: 12px 15px;
    margin: 8px 0;
    width: 100%;
}

.auth_wrapper .container button {
    border-radius: 20px;
    border: 1px solid #ff4b2b;
    background: #ff445c;
    color: #fff;
    font-size: 12px;
    font-weight: bold;
    padding: 12px 45px;
    letter-spacing: 1px;
    text-transform: uppercase;
    transition: transform 80ms ease-in;
}

.auth_wrapper .container button:active {
    transform: scale(.95);
}

.auth_wrapper .container button:focus {
    outline: none;
}

.auth_wrapper .container button.ghost {
    background: transparent;
    border-color: #fff;
}

.auth_wrapper .form-container {
    position: absolute;
    top: 0;
    height: 100%;
    transition: all .6s ease-in-out;
}

.auth_wrapper .sign-in-container {
    left: 0;
    width: 50%;
    z-index: 2;
}

.auth_wrapper .sign-up-container {
    left: 0;
    width: 50%;
    z-index: 1;
    opacity: 0;
}

.auth_wrapper .overlay-container {
    position: absolute;
    top: 0;
    left: 50%;
    width: 50%;
    height: 100%;
    overflow: hidden;
    transition: transform .6s ease-in-out;
    z-index: 100;
}

.auth_wrapper .overlay {
    background: linear-gradient(to right, #ff4b2b, #ff416c) no-repeat 0 0 / cover;
    color: #fff;
    position: relative;
    left: -100%;
    height: 100%;
    width: 200%;
    transform: translateY(0);
    transition: transform .6s ease-in-out;
}

.auth_wrapper .overlay-panel {
    position: absolute;
    top: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 0 40px;
    height: 100%;
    width: 40%;
    text-align: center;
    transform: translateY(0);
    transition: transform .6s ease-in-out;
}

.auth_wrapper .overlay-right {
    right: 0;
    transform: translateY(0);
}

.auth_wrapper .overlay-left {
    transform: translateY(-20%);
}

.auth_wrapper .container.right-panel-active .sign-in-container {
    transform: translateY(100%);
}

.auth_wrapper .container.right-panel-active .overlay-container {
    transform: translateX(-100%);
}

.auth_wrapper .container.right-panel-active .sign-up-container {
    transform: translateX(100%);
    opacity: 1;
    z-index: 5;
}

.auth_wrapper .container.right-panel-active .overlay {
    transform: translateX(50%);
}

.auth_wrapper .container.right-panel-active .overlay-left {
    transform: translateY(0);
}

.auth_wrapper .container.right-panel-active .overlay-right {
    transform: translateY(20%);
}

.auth_wrapper .container .footer {
    margin-top: 25px;
    text-align: center;
}

.auth_wrapper .container .icons {
    display: flex;
    width: 30px;
    height: 30px;
    letter-spacing: 15px;
    align-items: center;
}



================================================
FILE: css/styles.css
================================================
:root {
    --bg-color: #1a1a1a;
    --panel-bg-color: #2b2b2b;
    --header-bg-color: #1f1f1f;
    --text-color: #ffffff;
    --light-text-color: #cccccc;
    --highlight-color: #d12d2d;
    --border-color: #444;
    --button-bg-color: #444;
    --button-text-color: #fff;
    --input-bg-color: #3a3a3a;
    --input-border-color: #555;
    --padding-base: 15px;
    --border-radius-base: 4px;
}

body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: var(--bg-color);
    color: var(--text-color);
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    overflow-y: auto;
}

.container {
    width: 95%;
    max-width: 1200px;
    margin: 20px auto;
    background-color: var(--bg-color);
    border-radius: var(--border-radius-base);
    overflow: hidden;
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--padding-base);
    background-color: var(--header-bg-color);
    border-bottom: 1px solid var(--border-color);
    position: relative;
    z-index: 10;
}

.tabs {
    display: flex;
}

.tab-button {
    background-color: transparent;
    color: var(--light-text-color);
    border: none;
    padding: 10px 20px;
    cursor: pointer;
    font-size: 16px;
    border-bottom: 3px solid transparent;
    transition: all 0.2s ease-in-out;
}

.tab-button.active {
    color: var(--text-color);
    border-bottom: 3px solid var(--highlight-color);
}

.tab-button:hover:not(.active) {
    color: var(--text-color);
}

.logo {
    font-size: 30px;
    font-weight: bold;
    color: #ccc;
    padding-right: 10px;
    opacity: 0.7;
    line-height: 1;
}

.content {
    display: flex;
    min-height: 600px;
    background-color: var(--panel-bg-color);
    border-radius: 0 0 var(--border-radius-base) var(--border-radius-base);
}

.tab-content {
    display: flex;
    flex: 1;
}

.tab-content.hidden {
    display: none;
}

/* –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å (–¥–ª—è –≤–∫–ª–∞–¥–æ–∫ —Å –∑–∞–¥–∞—á–∞–º–∏) */
.left-panel {
    width: 300px;
    background-color: var(--panel-bg-color);
    border-right: 1px solid var(--border-color);
    padding: 0;
    overflow: hidden;
    max-height: calc(100vh - 150px);
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
}

.list-item {
    padding: var(--padding-base);
    border-bottom: 1px solid var(--border-color);
    cursor: pointer;
    transition: background-color 0.2s ease-in-out;
}

.list-item:hover {
    background-color: #3a3a3a;
}

.list-item.active {
    background-color: var(--highlight-color);
    color: var(--text-color);
    border-left: 5px solid var(--highlight-color);
    box-sizing: border-box;
    padding-left: calc(var(--padding-base) - 5px);
}

.list-item .item-id {
    font-weight: bold;
    margin-bottom: 5px;
}

.list-item .item-desc {
    font-size: 0.9em;
    color: var(--light-text-color);
}

.list-item.active .item-desc {
    color: var(--text-color);
}


/* –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å (–¥–ª—è –¥–µ—Ç–∞–ª–µ–π –∑–∞–¥–∞—á–∏) */
.right-panel {
    flex-grow: 1;
    padding: var(--padding-base) 30px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    position: relative;
}

.right-panel-title {
    font-size: 24px;
    margin-top: 0;
    margin-bottom: 20px;
    color: var(--text-color);
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 10px;
}

.right-panel .details p {
    margin: 5px 0;
    color: var(--light-text-color);
    font-size: 0.95em;
}

.right-panel-description {
    margin-top: 20px;
    margin-bottom: 20px;
    color: var(--light-text-color);
    font-size: 1em;
    white-space: pre-wrap; /* –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫ */
}

.screenshot-placeholder {
    flex-grow: 1;
    background-color: #333;
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius-base);
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    margin-bottom: 70px; /* –ú–µ—Å—Ç–æ –¥–ª—è —Ñ—É—Ç–µ—Ä–∞ */
    position: relative;
}

.screenshot-placeholder img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    opacity: 0.7;
}

.right-panel-footer {
    position: absolute;
    bottom: var(--padding-base);
    right: 30px;
    display: flex;
    gap: 10px;
}

/* –§–æ—Ä–º–∞ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ "–ù–æ–≤–∞—è" */
.new-task-form {
    flex: 1;
    display: flex;
    flex-direction: column;
    padding: var(--padding-base) 50px;
    gap: 20px;
    position: relative;
}

.form-row {
    display: flex;
    align-items: center;
    gap: 20px;
}

.form-row label {
    width: 120px;
    text-align: right;
    color: var(--light-text-color);
    flex-shrink: 0;
}

.form-row input[type="text"],
.form-row select,
.form-row textarea {
    flex-grow: 1;
    background-color: var(--input-bg-color);
    border: 1px solid var(--input-border-color);
    color: var(--text-color);
    padding: 10px 15px;
    border-radius: var(--border-radius-base);
    font-size: 1em;
    outline: none;
}

.form-row input[readonly] {
    background-color: #2f2f2f;
    cursor: default;
}

.form-row input[type="text"]:focus,
.form-row select:focus,
.form-row textarea:focus {
    border-color: var(--highlight-color);
    box-shadow: 0 0 0 2px rgba(209, 45, 45, 0.2);
}

.form-row select {
    appearance: none;
    -webkit-appearance: none;
    background-repeat: no-repeat;
    background-position: right 10px center;
    padding-right: 35px;
}

.text-area-row {
    align-items: flex-start;
}

.form-row textarea {
    min-height: 150px;
    resize: vertical;
}

.file-upload-row {
    align-items: flex-start;
}

.file-area {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.file-drop-area {
    min-height: 100px;
    border: 2px dashed var(--input-border-color);
    border-radius: var(--border-radius-base);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 15px;
    cursor: pointer;
    color: var(--light-text-color);
    transition: border-color 0.2s ease-in-out;
    position: relative;
}

.file-drop-area:hover, .file-drop-area.highlight {
    border-color: var(--highlight-color);
}

.download-icon {
    font-size: 3em;
    margin-top: 10px;
    color: var(--light-text-color);
}

#fileListContainer {
    display: flex;
    flex-direction: column;
    gap: 8px;
    max-height: 150px;
    overflow-y: auto;
}

.file-list-item {
    background-color: var(--input-bg-color);
    padding: 8px 12px;
    border-radius: var(--border-radius-base);
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.9em;
}

.file-remove-btn {
    background: transparent;
    border: none;
    color: #ff6b6b;
    cursor: pointer;
    font-size: 1.2em;
    font-weight: bold;
    padding: 0 5px;
}

.file-remove-btn:hover {
    color: #ff4757;
}

.form-footer {
    display: flex;
    justify-content: flex-end; /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –ø–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é */
    padding-top: 10px;
    margin-top: auto; /* –ü—Ä–∏–∂–∏–º–∞–µ—Ç —Ñ—É—Ç–µ—Ä –∫ –Ω–∏–∑—É, –µ—Å–ª–∏ –µ—Å—Ç—å –º–µ—Å—Ç–æ */
}


.action-button {
    background-color: var(--button-bg-color);
    color: var(--button-text-color);
    border: 1px solid var(--border-color);
    padding: 10px 20px;
    border-radius: var(--border-radius-base);
    cursor: pointer;
    font-size: 0.9em;
    transition: background-color 0.2s ease-in-out, border-color 0.2s ease-in-out;
}

.action-button:hover {
    background-color: #555;
    border-color: #666;
}

/* Toast notifications */
.toast-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 1000;
    max-width: 400px;
}

.toast {
    background-color: var(--panel-bg-color);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius-base);
    padding: 15px;
    margin-bottom: 10px;
    color: var(--text-color);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    opacity: 0;
    transform: translateX(100%);
    transition: all 0.3s ease-in-out;
    position: relative;
    word-wrap: break-word;
}

.toast.show {
    opacity: 1;
    transform: translateX(0);
}

.toast.success {
    border-left: 4px solid #4caf50;
}

.toast.error {
    border-left: 4px solid var(--highlight-color);
}

.toast.info {
    border-left: 4px solid #2196f3;
}

.toast-close {
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    color: var(--light-text-color);
    cursor: pointer;
    font-size: 18px;
    font-weight: bold;
    padding: 0;
    line-height: 1;
}

.toast-close:hover {
    color: var(--text-color);
}

/* Search container */
.search-container {
    padding: var(--padding-base);
    border-bottom: 1px solid var(--border-color);
}

.search-input {
    width: 100%;
    background-color: var(--input-bg-color);
    border: 1px solid var(--input-border-color);
    border-radius: var(--border-radius-base);
    padding: 10px;
    color: var(--text-color);
    font-size: 14px;
    box-sizing: border-box;
}

.search-input::placeholder {
    color: var(--light-text-color);
}

.search-input:focus {
    outline: none;
    border-color: var(--highlight-color);
}

.tasks-list {
    flex: 1;
    overflow-y: auto;
}

/* Task status badges */
.task-status-badge {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: bold;
    text-transform: uppercase;
    margin-left: 8px;
}

.task-status-badge.new {
    background-color: #4caf50;
    color: white;
}

.task-status-badge.in-progress {
    background-color: #ff9800;
    color: white;
}

.task-status-badge.done {
    background-color: #9e9e9e;
    color: white;
}

/* Files section */
.files-section {
    margin-top: 20px;
    border-top: 1px solid var(--border-color);
    padding-top: 20px;
}

.files-section h3 {
    margin: 0 0 15px 0;
    color: var(--text-color);
    font-size: 16px;
}

.files-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 15px;
    max-height: 200px;
    overflow-y: auto;
}

.file-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 10px;
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius-base);
    background-color: var(--input-bg-color);
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
}

.file-item:hover {
    border-color: var(--highlight-color);
    background-color: rgba(209, 45, 45, 0.1);
}

.file-thumbnail {
    width: 80px;
    height: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 8px;
    border-radius: 4px;
    overflow: hidden;
    background-color: var(--panel-bg-color);
}

.file-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 4px;
}

.file-icon {
    font-size: 32px;
    color: var(--light-text-color);
}

.file-name {
    font-size: 11px;
    color: var(--light-text-color);
    text-align: center;
    word-break: break-word;
    line-height: 1.2;
    max-height: 24px;
    overflow: hidden;
}

.file-size {
    font-size: 10px;
    color: var(--light-text-color);
    opacity: 0.7;
    margin-top: 2px;
}

/* File type icons */
.file-icon.image::before { content: "üñºÔ∏è"; }
.file-icon.document::before { content: "üìÑ"; }
.file-icon.pdf::before { content: "üìï"; }
.file-icon.audio::before { content: "üéµ"; }
.file-icon.video::before { content: "üé¨"; }
.file-icon.archive::before { content: "üì¶"; }
.file-icon.code::before { content: "üíª"; }
.file-icon.text::before { content: "üìù"; }
.file-icon.unknown::before { content: "‚ùì"; }

/* Modal for image preview */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
    z-index: 2000;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.modal.show {
    opacity: 1;
    visibility: visible;
}

.modal-content {
    position: relative;
    max-width: 90%;
    max-height: 90%;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.modal-close {
    position: absolute;
    top: -40px;
    right: 0;
    color: white;
    font-size: 32px;
    font-weight: bold;
    cursor: pointer;
    z-index: 2001;
    background-color: rgba(0, 0, 0, 0.5);
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
}

.modal-close:hover {
    background-color: rgba(209, 45, 45, 0.8);
}

#modalImage {
    max-width: 100%;
    max-height: 80vh;
    object-fit: contain;
    border-radius: var(--border-radius-base);
}

.modal-info {
    margin-top: 20px;
    text-align: center;
    color: white;
}

.modal-filename {
    font-size: 16px;
    margin-bottom: 10px;
    word-break: break-word;
}

.modal-actions {
    display: flex;
    gap: 10px;
    justify-content: center;
}

.modal-button {
    background-color: var(--highlight-color);
    color: white;
    padding: 8px 16px;
    text-decoration: none;
    border-radius: var(--border-radius-base);
    font-size: 14px;
    transition: background-color 0.2s ease;
}

.modal-button:hover {
    background-color: #b02525;
}

/* –°—Ç–∏–ª–∏ –∫–Ω–æ–ø–æ–∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ */
.auth-button {
    background-color: var(--highlight-color);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: var(--border-radius-base);
    cursor: pointer;
    font-size: 0.95em;
    font-weight: bold;
    letter-spacing: 0.5px;
    transition: background-color 0.3s ease, transform 0.2s ease;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
}

.auth-button:hover {
    background-color: #b02525;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(209, 45, 45, 0.3);
}

.auth-button:active {
    transform: translateY(0);
    box-shadow: 0 2px 5px rgba(209, 45, 45, 0.2);
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
@media (max-width: 768px) {
    .content {
        flex-direction: column;
    }

    .left-panel {
        width: 100%;
        max-height: 300px;
        border-right: none;
        border-bottom: 1px solid var(--border-color);
    }

    .right-panel, .new-task-form {
        padding: var(--padding-base);
    }

    .form-row {
        flex-direction: column;
        align-items: flex-start;
        gap: 5px;
    }

    .form-row label {
        width: auto;
        text-align: left;
    }

    .right-panel-footer, .form-footer {
        position: static;
        justify-content: flex-end;
        padding: var(--padding-base) 0;
    }
}

.auth-container-wrapper {
    display: flex;
    align-items: center;
}

.user-info-container {
    display: flex;
    align-items: center;
    gap: 15px; /* –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –∏–º–µ–Ω–µ–º –∏ –∫–Ω–æ–ø–∫–æ–π */
}

.username-display {
    font-weight: bold;
    color: var(--text-color);
    font-size: 1em;
}

/* –°–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç */
.hidden {
    display: none !important;
}


================================================
FILE: js/api.js
================================================
[Binary file]


================================================
FILE: js/auth.js
================================================
// js/auth.js (–∑–∞–º–µ–Ω–∏—Ç—å –≤—Å—ë —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ)

import {toast} from './toast.js';

const API_BASE_URL = 'http://127.0.0.1:8000/api/v1';

// –ò–°–ü–†–ê–í–õ–ï–ù–û: –ú–æ–¥–µ–ª—å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
class CreateUserModel {
    constructor({username, password, password_confirm}) {
        this.username = username;
        this.password = password;
        this.password_confirm = password_confirm;
    }
}

// –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
export const authApi = {
    /**
     * –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
     * @param {object} userData - –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è { username, password, password_confirm }.
     * @returns {Promise<object>} - –î–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
     */
    async createNewUser(userData) {
        // –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –º–æ–¥–µ–ª–∏ –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ –±—É–¥—É—â–µ–º
        const userToCreate = new CreateUserModel(userData);

        try {
            const response = await fetch(`${API_BASE_URL}/auth/register/`, { // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(userToCreate),
            });

            // –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç –Ω–µ —É—Å–ø–µ—à–Ω—ã–π, –ø–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
            if (!response.ok) {
                const errorData = await response.json();
                let messages = [];

                // –ï—Å–ª–∏ –µ—Å—Ç—å detail ‚Äî –¥–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–æ
                if (errorData.detail) {
                    messages.push(errorData.detail);
                }

                // –ï—Å–ª–∏ –µ—Å—Ç—å errors ‚Äî —Å–æ–±–∏—Ä–∞–µ–º –≤—Å–µ msg
                if (Array.isArray(errorData.errors)) {
                    messages.push(...errorData.errors.map(err => ":\n" + err.loc[1] + ":\n" + err.msg));
                }

                const errorMessage = "\n\n" + messages.join('\n');
                throw new Error(errorMessage || '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è');
            }

            // –ò–°–ü–†–ê–í–õ–ï–ù–û: –í–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∞ –Ω–µ TaskModel
            return await response.json();

        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);
            // –ü—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –¥–∞–ª—å—à–µ, —á—Ç–æ–±—ã –µ–µ –ø–æ–π–º–∞–ª –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤ handlers.js
            throw error;
        }
    },

    /**
     * –ê–≤—Ç–æ—Ä–∏–∑—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
     * @param {object} credentials - –î–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞ { username, password }.
     * @returns {Promise<object>} - –¢–æ–∫–µ–Ω—ã –¥–æ—Å—Ç—É–ø–∞.
     */
    async loginUser(credentials) {
        try {
            const response = await fetch(`${API_BASE_URL}/auth/login/`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(credentials),
            });

            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(errorData.detail || '–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏');
            }

            const data = await response.json();
            // localStorage.setItem('accessToken', data.access);
            // localStorage.setItem('refreshToken', data.refresh);
            return data;
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', error);
            throw error;
        }
    },
    // –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –¥–µ–ª–∞—Ç—å GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    // –ù–∞–ø—Ä–∏–º–µ—Ä, /api/v1/users/me/
    async getCurrentUser() {
        const response = await fetch(`${API_BASE_URL}/auth/users/me/`, { // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è "—Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
            method: 'GET',
        });
        if (!response.ok) {
            throw new Error('–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º');
        }
        return response.json(); // –û–∂–∏–¥–∞–µ–º { "username": "–∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" }
    }
};


================================================
FILE: js/handlers.js
================================================
import {api, TaskStatus} from './api.js';
import {toast} from './toast.js';
import {authApi} from './auth.js';

const newTabButton = document.getElementById('newTab');
const openTabButton = document.getElementById('openTab');
const closedTabButton = document.getElementById('closedTab');

const newContent = document.getElementById('newContent');
const openContent = document.getElementById('openContent');
const closedContent = document.getElementById('closedContent');

const fileDropArea = document.getElementById('fileDropArea');
const fileInput = document.getElementById('files');
const fileListContainer = document.getElementById('fileListContainer');
const newTaskForm = document.querySelector('.new-task-form');

const searchInput = document.getElementById('searchInput');
const searchInputClosed = document.getElementById('searchInputClosed');

const authModal = document.getElementById('authModal');
const authContainer = document.getElementById('authContainer');
const openAuthBtn = document.getElementById('registerBtn'); // –ö–Ω–æ–ø–∫–∞ "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è" –≤ —à–∞–ø–∫–µ
const switchToRegisterBtn = document.getElementById('switchToRegisterBtn');
const switchToLoginBtn = document.getElementById('switchToLoginBtn');
const registerForm = document.getElementById('registerForm');
const loginForm = document.getElementById('loginForm');
const loginButtonsBlock = document.getElementById('loginButtons')
const outButtons = document.getElementById('outButtons')
const logoutBtn = document.getElementById('logoutBtn')
// --- –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ---
let openTasksCache = [];
let closedTasksCache = [];
let selectedFiles = []; // –•—Ä–∞–Ω–∏—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª—ã
let searchTimeout = null;

/**
 * –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É.
 * @param {'new' | 'open' | 'closed'} activeTab - –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤–∫–ª–∞–¥–∫–∏.
 */
function switchTab(activeTab) {
    [newTabButton, openTabButton, closedTabButton].forEach(btn => btn.classList.remove('active'));
    [newContent, openContent, closedContent].forEach(content => content.classList.add('hidden'));

    if (activeTab === 'new') {
        newTabButton.classList.add('active');
        newContent.classList.remove('hidden');
    } else if (activeTab === 'open') {
        openTabButton.classList.add('active');
        openContent.classList.remove('hidden');
        loadTasks(openContent, (search) => api.getOpenTasks(search), openTasksCache, 'open');
    } else if (activeTab === 'closed') {
        closedTabButton.classList.add('active');
        closedContent.classList.remove('hidden');
        loadTasks(closedContent, (search) => api.getClosedTasks(search), closedTasksCache, 'closed');
    }
}

/**
 * –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∑–∞–¥–∞—á–∏.
 * @param {HTMLElement} contentElement - –≠–ª–µ–º–µ–Ω—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤–∫–ª–∞–¥–∫–∏ (`openContent` –∏–ª–∏ `closedContent`).
 * @param {(search: string) => Promise<import('./api.js').TaskModel[]>} fetchApiCall - –§—É–Ω–∫—Ü–∏—è API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–¥–∞—á.
 * @param {import('./api.js').TaskModel[]} cacheArray - –ú–∞—Å—Å–∏–≤ –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á.
 * @param {string} tabType - –¢–∏–ø –≤–∫–ª–∞–¥–∫–∏ ('open' –∏–ª–∏ 'closed').
 */
async function loadTasks(contentElement, fetchApiCall, cacheArray, tabType) {
    const listItemsContainer = contentElement.querySelector('.tasks-list');
    const rightPanelContainer = contentElement.querySelector('.right-panel');
    const searchInput = contentElement.querySelector('.search-input');
    const searchQuery = searchInput ? searchInput.value : '';

    try {
        const tasks = await fetchApiCall(searchQuery);
        cacheArray.splice(0, cacheArray.length, ...tasks); // –û—á–∏—â–∞–µ–º –∏ –∑–∞–ø–æ–ª–Ω—è–µ–º –∫—ç—à

        listItemsContainer.innerHTML = '';
        if (tasks.length === 0) {
            const emptyMessage = searchQuery
                ? '–ü–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.'
                : '–ó–∞–¥–∞—á –Ω–µ—Ç.';
            listItemsContainer.innerHTML = `<div style="padding: var(--padding-base); text-align: center; color: var(--light-text-color);">${emptyMessage}</div>`;
            clearRightPanel(rightPanelContainer);
            return;
        }

        tasks.forEach(task => {
            const listItem = document.createElement('div');
            listItem.className = 'list-item';
            listItem.dataset.itemId = task.id;

            // –î–æ–±–∞–≤–ª—è–µ–º –±–µ–π–¥–∂ —Å—Ç–∞—Ç—É—Å–∞ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∑–∞–¥–∞—á
            const statusBadge = tabType === 'open' ? getStatusBadge(task.status) : '';

            listItem.innerHTML = `
                <div class="item-id">${task.project}-${task.id}${statusBadge}</div>
                <div class="item-desc">${task.title}</div>`;
            listItem.addEventListener('click', () => handleListItemClick(task.id, contentElement));
            listItemsContainer.appendChild(listItem);
        });

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ–º –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç
        if (listItemsContainer.firstElementChild && !listItemsContainer.firstElementChild.textContent.includes('–ü–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É')) {
            listItemsContainer.firstElementChild.click();
        } else {
            clearRightPanel(rightPanelContainer);
        }

    } catch (error) {
        console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞–¥–∞—á–∏:', error);
        toast.error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞—á: ${error.message}`);
        listItemsContainer.innerHTML = '<div style="padding: var(--padding-base); text-align: center; color: var(--highlight-color);">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞—á.</div>';
        clearRightPanel(rightPanelContainer);
    }
}

/**
 * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç HTML –¥–ª—è –±–µ–π–¥–∂–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏.
 * @param {string} status - –°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏.
 * @returns {string} HTML —Å—Ç—Ä–æ–∫–∞ —Å –±–µ–π–¥–∂–µ–º.
 */
function getStatusBadge(status) {
    const statusLabels = {
        [TaskStatus.NEW]: '–ù–æ–≤–∞—è',
        [TaskStatus.IN_PROGRESS]: '–í –ø—Ä–æ—Ü–µ—Å—Å–µ',
        [TaskStatus.DONE]: '–í—ã–ø–æ–ª–Ω–µ–Ω–∞'
    };

    const statusClass = status.replace('_', '-');
    const label = statusLabels[status] || status;

    return `<span class="task-status-badge ${statusClass}">${label}</span>`;
}

/**
 * –û—á–∏—â–∞–µ—Ç –ø—Ä–∞–≤—É—é –ø–∞–Ω–µ–ª—å —Å –¥–µ—Ç–∞–ª—è–º–∏ –∑–∞–¥–∞—á–∏.
 * @param {HTMLElement} rightPanelContainer - –≠–ª–µ–º–µ–Ω—Ç –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏.
 */
function clearRightPanel(rightPanelContainer) {
    rightPanelContainer.querySelector('.right-panel-title').textContent = '–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–¥–∞—á—É';
    rightPanelContainer.querySelector('.right-panel .details').innerHTML = '';
    rightPanelContainer.querySelector('.right-panel-description').textContent = '';

    // –û—á–∏—â–∞–µ–º —Ñ–∞–π–ª—ã
    const filesGrid = rightPanelContainer.querySelector('.files-grid');
    if (filesGrid) {
        filesGrid.innerHTML = '';
    }
}

/**
 * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–µ—Ç–∞–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏.
 * @param {import('./api.js').TaskModel} task - –û–±—ä–µ–∫—Ç –∑–∞–¥–∞—á–∏.
 * @param {HTMLElement} rightPanelContainer - –≠–ª–µ–º–µ–Ω—Ç –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏.
 */
function displayTaskDetails(task, rightPanelContainer) {
    rightPanelContainer.querySelector('.right-panel-title').textContent = task.title;
    rightPanelContainer.querySelector('.details').innerHTML = `
        <p>–î–∞—Ç–∞: ${task.created_at.toLocaleDateString()} - ${task.updated_at.toLocaleDateString()}</p>
        <p>–ü—Ä–æ–µ–∫—Ç: ${task.project}</p>
        <p>–õ–ü–£: ${task.organisation}</p>`;
    rightPanelContainer.querySelector('.right-panel-description').textContent = task.description;

    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã
    displayTaskFiles(task.files, rightPanelContainer);
}

/**
 * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ñ–∞–π–ª—ã –∑–∞–¥–∞—á–∏ –≤ —Å–µ—Ç–∫–µ.
 * @param {import('./api.js').FileModel[]} files - –ú–∞—Å—Å–∏–≤ —Ñ–∞–π–ª–æ–≤.
 * @param {HTMLElement} rightPanelContainer - –≠–ª–µ–º–µ–Ω—Ç –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏.
 */
function displayTaskFiles(files, rightPanelContainer) {
    const filesGrid = rightPanelContainer.querySelector('.files-grid');

    if (!filesGrid) {
        console.error('–≠–ª–µ–º–µ–Ω—Ç .files-grid –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ DOM');
        return;
    }

    if (!files || files.length === 0) {
        filesGrid.innerHTML = '<div style="grid-column: 1 / -1; text-align: center; color: var(--light-text-color); padding: 20px;">–§–∞–π–ª—ã –Ω–µ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω—ã</div>';
        return;
    }

    filesGrid.innerHTML = '';

    files.forEach(file => {
        const fileItem = document.createElement('div');
        fileItem.className = 'file-item';
        fileItem.dataset.fileId = file.id;

        const thumbnail = createFileThumbnail(file);
        const fileName = document.createElement('div');
        fileName.className = 'file-name';
        fileName.textContent = file.filename;

        const fileSize = document.createElement('div');
        fileSize.className = 'file-size';
        fileSize.textContent = formatFileSize(file.size || 0);

        fileItem.appendChild(thumbnail);
        fileItem.appendChild(fileName);
        fileItem.appendChild(fileSize);

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
        fileItem.addEventListener('click', () => handleFileClick(file));

        filesGrid.appendChild(fileItem);
    });
}

/**
 * –°–æ–∑–¥–∞–µ—Ç –º–∏–Ω–∏–∞—Ç—é—Ä—É —Ñ–∞–π–ª–∞.
 * @param {import('./api.js').FileModel} file - –û–±—ä–µ–∫—Ç —Ñ–∞–π–ª–∞.
 * @returns {HTMLElement} –≠–ª–µ–º–µ–Ω—Ç –º–∏–Ω–∏–∞—Ç—é—Ä—ã.
 */
function createFileThumbnail(file) {
    const thumbnail = document.createElement('div');
    thumbnail.className = 'file-thumbnail';

    if (file.mimetype && file.mimetype.startsWith('image/')) {
        const img = document.createElement('img');
        img.src = file.url;
        img.alt = file.filename;
        img.onerror = () => {
            // –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–æ—Å—å, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–∫–æ–Ω–∫—É
            thumbnail.innerHTML = '<div class="file-icon image"></div>';
        };
        thumbnail.appendChild(img);
    } else {
        const icon = document.createElement('div');
        icon.className = `file-icon ${getFileTypeClass(file.mimetype)}`;
        thumbnail.appendChild(icon);
    }

    return thumbnail;
}

/**
 * –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–ª–∞—Å—Å CSS –¥–ª—è —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞.
 * @param {string} mimetype - MIME —Ç–∏–ø —Ñ–∞–π–ª–∞.
 * @returns {string} –ö–ª–∞—Å—Å CSS.
 */
function getFileTypeClass(mimetype) {
    if (!mimetype) return 'unknown';

    if (mimetype.startsWith('image/')) return 'image';
    if (mimetype.startsWith('video/')) return 'video';
    if (mimetype.startsWith('audio/')) return 'audio';
    if (mimetype.includes('pdf')) return 'pdf';
    if (mimetype.includes('text/') || mimetype.includes('json') || mimetype.includes('xml')) return 'text';
    if (mimetype.includes('zip') || mimetype.includes('rar') || mimetype.includes('7z')) return 'archive';
    if (mimetype.includes('javascript') || mimetype.includes('python') || mimetype.includes('java')) return 'code';
    if (mimetype.includes('document') || mimetype.includes('word') || mimetype.includes('excel')) return 'document';

    return 'unknown';
}

/**
 * –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ —á–∏—Ç–∞–µ–º—ã–π –≤–∏–¥.
 * @param {number} bytes - –†–∞–∑–º–µ—Ä –≤ –±–∞–π—Ç–∞—Ö.
 * @returns {string} –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä.
 */
function formatFileSize(bytes) {
    if (bytes === 0) return '';

    const k = 1024;
    const sizes = ['B', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));

    return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
}

/**
 * –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–ª–∏–∫ –ø–æ —Ñ–∞–π–ª—É.
 * @param {import('./api.js').FileModel} file - –û–±—ä–µ–∫—Ç —Ñ–∞–π–ª–∞.
 */
function handleFileClick(file) {
    if (file.mimetype && file.mimetype.startsWith('image/')) {
        // –î–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –æ—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        openImageModal(file);
    } else {
        // –î–ª—è –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ—Å—Ç–æ —Å–∫–∞—á–∏–≤–∞–µ–º
        downloadFile(file);
    }
}

/**
 * –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º.
 * @param {import('./api.js').FileModel} file - –û–±—ä–µ–∫—Ç —Ñ–∞–π–ª–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
 */
function openImageModal(file) {
    const modal = document.getElementById('imageModal');
    if (!modal) {
        console.error('–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ imageModal –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
        return;
    }

    const modalImage = document.getElementById('modalImage');
    const modalFilename = modal.querySelector('.modal-filename');
    const modalDownload = document.getElementById('modalDownload');

    if (!modalImage || !modalFilename || !modalDownload) {
        console.error('–≠–ª–µ–º–µ–Ω—Ç—ã –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
        return;
    }

    modalImage.src = file.url;
    modalImage.alt = file.filename;
    modalFilename.textContent = file.filename;
    modalDownload.href = file.url;
    modalDownload.download = file.filename;

    modal.classList.remove('hidden');
    setTimeout(() => modal.classList.add('show'), 10);
}

/**
 * –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º.
 */
function closeImageModal() {
    const modal = document.getElementById('imageModal');
    if (!modal) {
        console.error('–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ imageModal –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
        return;
    }

    modal.classList.remove('show');
    setTimeout(() => modal.classList.add('hidden'), 300);
}

/**
 * –°–∫–∞—á–∏–≤–∞–µ—Ç —Ñ–∞–π–ª.
 * @param {import('./api.js').FileModel} file - –û–±—ä–µ–∫—Ç —Ñ–∞–π–ª–∞.
 */
function downloadFile(file) {
    const link = document.createElement('a');
    link.href = file.url;
    link.download = file.filename;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}

/**
 * –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–ª–∏–∫ –ø–æ —ç–ª–µ–º–µ–Ω—Ç—É —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á.
 * @param {number} taskId - ID –∑–∞–¥–∞—á–∏.
 * @param {HTMLElement} currentContentElement - –¢–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤–∫–ª–∞–¥–∫–∏.
 */
async function handleListItemClick(taskId, currentContentElement) {
    const rightPanelContainer = currentContentElement.querySelector('.right-panel');
    const cache = (currentContentElement === openContent) ? openTasksCache : closedTasksCache;

    // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ —Å—Ç–∞—Ä–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏ –≤—ã–¥–µ–ª—è–µ–º –Ω–æ–≤—ã–π
    const currentActive = currentContentElement.querySelector('.list-item.active');
    if (currentActive) currentActive.classList.remove('active');
    currentContentElement.querySelector(`.list-item[data-item-id="${taskId}"]`).classList.add('active');

    try {
        let task = cache.find(t => t.id === taskId);
        if (!task) task = await api.getTaskById(taskId); // –ï—Å–ª–∏ –≤ –∫—ç—à–µ –Ω–µ—Ç, –∑–∞–≥—Ä—É–∂–∞–µ–º
        displayTaskDetails(task, rightPanelContainer);
    } catch (error) {
        console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–µ—Ç–∞–ª–µ–π –∑–∞–¥–∞—á–∏ ${taskId}:`, error);
        toast.error(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –∑–∞–¥–∞—á–∏: ${error.message}`);
        clearRightPanel(rightPanelContainer);
    }
}

/**
 * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ —Ñ–æ—Ä–º–µ.
 */
function renderFileList() {
    fileListContainer.innerHTML = ''; // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
    if (selectedFiles.length === 0) {
        fileDropArea.querySelector('span').style.display = 'block';
        fileDropArea.childNodes[0].nodeValue = '–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∏—Ö —Å—é–¥–∞';
    } else {
        fileDropArea.querySelector('span').style.display = 'none';
        fileDropArea.childNodes[0].nodeValue = `–í—ã–±—Ä–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: ${selectedFiles.length}. –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –µ—â–µ –∏–ª–∏ –∫–ª–∏–∫–Ω–∏—Ç–µ.`;
    }

    selectedFiles.forEach((file, index) => {
        const fileItem = document.createElement('div');
        fileItem.className = 'file-list-item';
        fileItem.textContent = file.name;

        const removeBtn = document.createElement('button');
        removeBtn.className = 'file-remove-btn';
        removeBtn.textContent = '√ó';
        removeBtn.type = 'button'; // –í–∞–∂–Ω–æ, —á—Ç–æ–±—ã –Ω–µ —Å–∞–±–º–∏—Ç–∏—Ç—å —Ñ–æ—Ä–º—É
        removeBtn.onclick = () => {
            selectedFiles.splice(index, 1); // –£–¥–∞–ª—è–µ–º —Ñ–∞–π–ª –∏–∑ –º–∞—Å—Å–∏–≤–∞
            renderFileList(); // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫
        };

        fileItem.appendChild(removeBtn);
        fileListContainer.appendChild(fileItem);
    });
}

/**
 * –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ (—á–µ—Ä–µ–∑ drag-n-drop –∏–ª–∏ –≤—ã–±–æ—Ä).
 * @param {FileList} newFiles - –°–ø–∏—Å–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.
 */
function handleFiles(newFiles) {
    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º FileList –≤ –º–∞—Å—Å–∏–≤ –∏ –¥–æ–±–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
    Array.from(newFiles).forEach(file => {
        if (!selectedFiles.some(f => f.name === file.name && f.size === file.size)) {
            selectedFiles.push(file);
        }
    });
    renderFileList(); // –û–±–Ω–æ–≤–ª—è–µ–º UI
}

/**
 * –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–∏—Å–∫ –∑–∞–¥–∞—á —Å –¥–µ–±–∞—É–Ω—Å–æ–º.
 * @param {HTMLElement} contentElement - –≠–ª–µ–º–µ–Ω—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤–∫–ª–∞–¥–∫–∏.
 * @param {(search: string) => Promise<import('./api.js').TaskModel[]>} fetchApiCall - –§—É–Ω–∫—Ü–∏—è API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–¥–∞—á.
 * @param {import('./api.js').TaskModel[]} cacheArray - –ú–∞—Å—Å–∏–≤ –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á.
 * @param {string} tabType - –¢–∏–ø –≤–∫–ª–∞–¥–∫–∏ ('open' –∏–ª–∏ 'closed').
 */
function handleSearch(contentElement, fetchApiCall, cacheArray, tabType) {
    // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ç–∞–π–º–∞—É—Ç
    if (searchTimeout) {
        clearTimeout(searchTimeout);
    }

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—ã–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è –¥–µ–±–∞—É–Ω—Å–∞
    searchTimeout = setTimeout(() => {
        loadTasks(contentElement, fetchApiCall, cacheArray, tabType);
    }, 300); // 300–º—Å –∑–∞–¥–µ—Ä–∂–∫–∞
}

/**
 * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å,
 * –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç UI —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.
 */
async function checkInitialAuthStatus() {
    try {
        // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ. –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –µ—Å—Ç—å –∏ –æ–Ω –≤–∞–ª–∏–¥–µ–Ω, –≤—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è.
        const user = await authApi.getCurrentUser();
        loginButtonsBlock.classList.remove('show');
        loginButtonsBlock.classList.add('hidden');
        outButtons.classList.remove('hidden');
        outButtons.classList.add('show');
    } catch (error) {
        // –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω–∞ –Ω–µ—Ç –∏–ª–∏ –æ–Ω –Ω–µ–≤–∞–ª–∏–¥–µ–Ω, —Ñ—É–Ω–∫—Ü–∏—è getCurrentUser() –≤—ã–∑–æ–≤–µ—Ç –æ—à–∏–±–∫—É.
        outButtons.classList.remove('show');
        outButtons.classList.add('hidden');
        loginButtonsBlock.classList.remove('hidden');
        loginButtonsBlock.classList.add('show');
    }
}

/** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π */
export function setupEventListeners() {
    checkInitialAuthStatus()
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
    newTabButton.addEventListener('click', () => switchTab('new'));
    openTabButton.addEventListener('click', () => switchTab('open'));
    closedTabButton.addEventListener('click', () => switchTab('closed'));

    // –ü–æ–∏—Å–∫ –∑–∞–¥–∞—á
    if (searchInput) {
        searchInput.addEventListener('input', () => {
            handleSearch(openContent, (search) => api.getOpenTasks(search), openTasksCache, 'open');
        });
    }

    if (searchInputClosed) {
        searchInputClosed.addEventListener('input', () => {
            handleSearch(closedContent, (search) => api.getClosedTasks(search), closedTasksCache, 'closed');
        });
    }

    // --- –õ–æ–≥–∏–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ ---
    fileDropArea.addEventListener('click', () => fileInput.click());
    fileInput.addEventListener('change', () => handleFiles(fileInput.files));

    // Drag and Drop
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        fileDropArea.addEventListener(eventName, e => {
            e.preventDefault();
            e.stopPropagation();
        }, false);
    });
    ['dragenter', 'dragover'].forEach(eventName => {
        fileDropArea.addEventListener(eventName, () => fileDropArea.classList.add('highlight'), false);
    });
    ['dragleave', 'drop'].forEach(eventName => {
        fileDropArea.addEventListener(eventName, () => fileDropArea.classList.remove('highlight'), false);
    });
    fileDropArea.addEventListener('drop', e => handleFiles(e.dataTransfer.files), false);

    // --- –õ–æ–≥–∏–∫–∞ –¥–ª—è —Ñ–æ—Ä–º—ã —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏ ---
    newTaskForm.addEventListener('submit', async (event) => {
        event.preventDefault();
        const lpuInput = document.getElementById('lpu');

        const taskData = {
            title: document.getElementById('subject').value,
            description: document.getElementById('text').value,
            project: document.getElementById('taskType').value,
            organisation: lpuInput.value, // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ, –∞ –Ω–µ –∫–æ–¥
        };

        try {
            // 1. –°–æ–∑–¥–∞–µ–º –∑–∞–¥–∞—á—É
            const newTask = await api.createTask(taskData);
            toast.success(`–ó–∞–¥–∞—á–∞ "${newTask.title}" (ID: ${newTask.id}) —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!`);

            // 2. –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª—ã, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
            if (selectedFiles.length > 0) {
                await api.uploadFilesForTask(newTask.id, selectedFiles);
                toast.success(`–§–∞–π–ª—ã (${selectedFiles.length} —à—Ç.) —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–ª—è –∑–∞–¥–∞—á–∏ ${newTask.id}.`);
            }

            // 3. –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –∏ –æ—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
            newTaskForm.reset();
            selectedFiles = [];
            renderFileList();
            switchTab('open'); // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É —Å –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞—á–∏ –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–æ–≤:', error);
            toast.error(`–û—à–∏–±–∫–∞: ${error.message || '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É.'}`);
        }
    });

    // --- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ ---
    const imageModal = document.getElementById('imageModal');

    if (imageModal) {
        const modalClose = imageModal.querySelector('.modal-close');

        if (modalClose) {
            modalClose.addEventListener('click', closeImageModal);
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ –∫–ª–∏–∫—É –Ω–∞ —Ñ–æ–Ω
        imageModal.addEventListener('click', (e) => {
            if (e.target === imageModal) {
                closeImageModal();
            }
        });
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ –Ω–∞–∂–∞—Ç–∏—é Escape
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            const imageModal = document.getElementById('imageModal');
            if (imageModal && !imageModal.classList.contains('hidden')) {
                closeImageModal();
            }
        }
    });

    // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    openAuthBtn.addEventListener("click", () => {
        authModal.classList.remove('hidden');
        setTimeout(() => authModal.classList.add('show'), 10); // –ü–ª–∞–≤–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ –∫–ª–∏–∫—É –Ω–∞ —Ñ–æ–Ω
    authModal.addEventListener('click', (e) => {
        if (e.target === authModal) {
            authModal.classList.remove('show');
            setTimeout(() => authModal.classList.add('hidden'), 300);
        }
    });

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –ø–∞–Ω–µ–ª—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
    switchToRegisterBtn.addEventListener('click', () => {
        authContainer.classList.add('right-panel-active');
    });

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –ø–∞–Ω–µ–ª—å –≤—Ö–æ–¥–∞
    switchToLoginBtn.addEventListener('click', () => {
        authContainer.classList.remove('right-panel-active');
    });

    // –ù–û–í–´–ô –û–ë–†–ê–ë–û–¢–ß–ò–ö: –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
    registerForm.addEventListener('submit', async (event) => {
        event.preventDefault(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É —Ñ–æ—Ä–º—ã

        const formData = new FormData(registerForm);
        const data = Object.fromEntries(formData.entries());

        // –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
        if (data.password !== data.password_confirm) {
            toast.error('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!');
            return;
        }

        try {
            const newUser = await authApi.createNewUser(data);
            toast.success(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${newUser.username} —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!`);
            registerForm.reset(); // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º –Ω–∞ –ø–∞–Ω–µ–ª—å –≤—Ö–æ–¥–∞
            authContainer.classList.remove('right-panel-active');

        } catch (error) {
            toast.error(`–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ${error.message}`);
        }
    });


    loginForm.addEventListener('submit', async (event) => {
        event.preventDefault();

        const formData = new FormData(loginForm);
        const data = Object.fromEntries(formData.entries());

        try {
            await authApi.loginUser(data);
            toast.success(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${data.username}!`);
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏ –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            authModal.classList.remove('show');
            setTimeout(() => authModal.classList.add('hidden'), 300);
            loginButtonsBlock.classList.add('hidden')
            outButtons.classList.remove('hidden')
            outButtons.classList.add('show')
            // TODO: –û–±–Ω–æ–≤–∏—Ç—å UI, –ø–æ–∫–∞–∑–∞—Ç—å –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫–∏ "–í—Ö–æ–¥/–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è"
        } catch (error) {
            toast.error(`–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: ${error.message}`);
        }
    });

    logoutBtn.addEventListener('submit')
}



================================================
FILE: js/main.js
================================================
import { setupEventListeners } from './handlers.js';

document.addEventListener('DOMContentLoaded', () => {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
    setupEventListeners();

    // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ—Ç–∫—Ä—ã–≤–∞–µ–º –≤–∫–ª–∞–¥–∫—É "–ù–æ–≤–∞—è"
    document.getElementById('newTab').click();
});


================================================
FILE: js/toast.js
================================================
/**
 * Toast notification system
 */

const TOAST_TYPES = {
    SUCCESS: 'success',
    ERROR: 'error',
    INFO: 'info'
};

const TOAST_DURATION = {
    SHORT: 3000,
    MEDIUM: 5000,
    LONG: 8000
};

class ToastManager {
    constructor() {
        this.container = document.getElementById('toastContainer');
        if (!this.container) {
            console.error('Toast container not found! Make sure there is an element with id="toastContainer"');
        }
    }

    /**
     * –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
     * @param {string} message - –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
     * @param {string} type - –¢–∏–ø —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (success, error, info)
     * @param {number} duration - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–∫–∞–∑–∞ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
     */
    show(message, type = TOAST_TYPES.INFO, duration = TOAST_DURATION.MEDIUM) {
        if (!this.container) return;

        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        
        const closeButton = document.createElement('button');
        closeButton.className = 'toast-close';
        closeButton.innerHTML = '√ó';
        closeButton.addEventListener('click', () => this.remove(toast));

        toast.innerHTML = `
            <div>${message}</div>
        `;
        toast.appendChild(closeButton);

        this.container.appendChild(toast);

        // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
        setTimeout(() => {
            toast.classList.add('show');
        }, 10);

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
        setTimeout(() => {
            this.remove(toast);
        }, duration);

        return toast;
    }

    /**
     * –£–¥–∞–ª—è–µ—Ç toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
     * @param {HTMLElement} toast - –≠–ª–µ–º–µ–Ω—Ç toast
     */
    remove(toast) {
        if (!toast || !toast.parentNode) return;

        toast.classList.remove('show');
        setTimeout(() => {
            if (toast.parentNode) {
                toast.parentNode.removeChild(toast);
            }
        }, 300);
    }

    /**
     * –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
     * @param {string} message - –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
     * @param {number} duration - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–∫–∞–∑–∞
     */
    success(message, duration = TOAST_DURATION.MEDIUM) {
        return this.show(message, TOAST_TYPES.SUCCESS, duration);
    }

    /**
     * –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
     * @param {string} message - –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
     * @param {number} duration - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–∫–∞–∑–∞
     */
    error(message, duration = TOAST_DURATION.LONG) {
        return this.show(message, TOAST_TYPES.ERROR, duration);
    }

    /**
     * –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
     * @param {string} message - –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
     * @param {number} duration - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–∫–∞–∑–∞
     */
    info(message, duration = TOAST_DURATION.MEDIUM) {
        return this.show(message, TOAST_TYPES.INFO, duration);
    }

    /**
     * –û—á–∏—â–∞–µ—Ç –≤—Å–µ toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
     */
    clear() {
        if (!this.container) return;
        
        const toasts = this.container.querySelectorAll('.toast');
        toasts.forEach(toast => this.remove(toast));
    }
}

// –°–æ–∑–¥–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä
const toast = new ToastManager();

export { toast, TOAST_TYPES, TOAST_DURATION };


